import{j as e}from"./jsx-runtime.CYYqVSlZ.js";import{r as i,R as L}from"./index.DJO9vBfz.js";import{e as M,f as R,d as T,c as O}from"./index.esm2017.DO3flr3L.js";import{d as k}from"./client.CxEmRUlx.js";function $(t){const n=document.getElementById(t);n?.classList.remove("opacity-0","pointer-events-none"),n?.classList.add("opacity-100","pointer-events-auto")}function D(t){const n=document.getElementById(t);n?.classList.add("opacity-0","pointer-events-none"),n?.classList.remove("opacity-100","pointer-events-auto")}function S(t){const n=document.getElementById(t);n?.addEventListener("click",function(c){c.target===n&&D(t)}),document.addEventListener("keydown",function(c){c.key==="Escape"&&D(t)})}const x=({className:t,...n})=>e.jsx("input",{className:`px-3 py-2 bg-white border shadow-sm border-gray-100 placeholder-slate-400 focus:outline-none focus:border-gray-100 focus:ring-gray-200 block w-full rounded-3xl sm:text-sm focus:ring-1 ${t}`,...n}),G=({className:t,...n})=>e.jsx("input",{className:`px-3 py-2 bg-white border shadow-sm border-customGreen placeholder-slate-400 focus:outline-none focus:border-customGreen focus:ring-customGreen block w-full rounded-3xl sm:text-sm focus:ring-1 ${t}`,...n}),P=({className:t,...n})=>e.jsx("button",{className:`px-4 py-2 font-semibold text-sm text-gray-600 underline ${t}`,...n}),g=({className:t,...n})=>e.jsx("button",{className:`px-6 py-2 font-semibold text-sm bg-customBlue text-white rounded-full shadow-sm ${t}`,...n}),A=({className:t,...n})=>e.jsx("button",{className:`flex items-center justify-center w-8 h-8 font-semibold text-sm bg-customBlue text-white rounded-full shadow-sm ${t}`,...n}),V=({children:t})=>e.jsx("div",{className:"overflow-hidden rounded-lg shadow-custom",children:e.jsx("table",{className:"min-w-full divide-y-[3px] divide-black/10 border-collapse separate",children:t})}),F=({children:t})=>e.jsx("thead",{className:"bg-black/5",children:t}),_=({children:t})=>e.jsx("tbody",{className:"bg-gray-50 divide-y-[3px] divide-black/10 line-clamp",children:t}),b=({children:t})=>e.jsx("tr",{children:t}),h=({children:t})=>e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-sm font-base text-customBlack tracking-wider",children:t}),d=({children:t,colSpan:n})=>e.jsx("td",{className:"px-6 py-2 whitespace-nowrap",colSpan:n,children:t}),q=({children:t,colSpan:n,className:c})=>e.jsx("td",{className:`whitespace-nowrap ${c}`,colSpan:n,children:t}),N=3,Q=()=>{const[t,n]=i.useState([]),[c,v]=i.useState([]),[f,U]=i.useState(""),[p,j]=i.useState(1),[o,y]=i.useState(null);i.useEffect(()=>{(async()=>{try{const s=await M(R(k,"users")),r=[];s.forEach(l=>{const u=l.data();r.push({id:l.id,name:u.name||"",dni:u.dni||"",matricula:u.matricula||"",lugarDeOrigen:u.lugarDeOrigen||"",infoExtra:u.infoExtra||"",profileImageUrl:u.profileImageUrl||""})}),n(r)}catch(s){console.error("Error fetching users: ",s)}})()},[]),i.useEffect(()=>(S("register-modal"),()=>{document.removeEventListener("keydown",S)}),[]);const B=a=>{v(s=>s.includes(a)?[]:[a])},m=(a,s)=>{o&&y({...o,[a]:s})},I=async a=>{if(o){const s=T(k,"users",a);await O(s,{name:o.name,dni:o.dni,matricula:o.matricula,lugarDeOrigen:o.lugarDeOrigen,infoExtra:o.infoExtra,profileImageUrl:o.profileImageUrl}),n(r=>r.map(l=>l.id===a?{...l,...o}:l)),v(r=>r.filter(l=>l!==a)),y(null)}},E=t.filter(a=>a.name.toLowerCase().includes(f.toLowerCase())||a.dni.includes(f)||a.matricula.includes(f)),w=Math.ceil(E.length/N),C=E.slice((p-1)*N,p*N);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-grid justify-between",children:[e.jsx(G,{type:"text",placeholder:"Buscar por nombre, DNI o matrícula",value:f,onChange:a=>U(a.target.value),className:"w-full max-w-sm border-customGreen rounded-3xl"}),e.jsx("a",{href:"#",onClick:a=>{a.preventDefault(),$("register-modal")},className:"bg-customBlue text-white px-4 py-3 rounded-2xl text-sm font-semibold",children:"Agregar Miembro"})]}),e.jsxs(V,{children:[e.jsx(F,{children:e.jsxs(b,{children:[e.jsx(h,{children:"Nombre"}),e.jsx(h,{children:"Dni"}),e.jsx(h,{children:"Matrícula"}),e.jsx(h,{children:"Lugar de Origen"}),e.jsx(h,{children:"Info Extra"}),e.jsx(h,{children:"Edición"})]})}),e.jsx(_,{children:C.length>0?C.map(a=>e.jsxs(L.Fragment,{children:[e.jsxs(b,{children:[e.jsx(d,{children:a.name}),e.jsx(d,{children:a.dni}),e.jsx(d,{children:a.matricula}),e.jsx(d,{children:a.lugarDeOrigen}),e.jsx(d,{children:a.infoExtra}),e.jsx(d,{children:e.jsx(P,{className:`transition-all duration-200 ${c.includes(a.id)?"font-bold text-xl":""}`,onClick:()=>{B(a.id),y(a)},children:"Mas Detalle"})})]}),c.includes(a.id)&&e.jsx(b,{children:e.jsx(q,{colSpan:6,className:"p-0",children:e.jsxs("div",{className:"bg-gray-100 p-10 m-0 rounded-none",children:[e.jsx("h3",{className:"font-bold mb-2",children:"Detalles adicionales"}),e.jsx(x,{placeholder:"Nombre",defaultValue:a.name,onChange:s=>m("name",s.target.value),className:"mb-2"}),e.jsx(x,{placeholder:"DNI",defaultValue:a.dni,onChange:s=>m("dni",s.target.value),className:"mb-2"}),e.jsx(x,{placeholder:"Matrícula",defaultValue:a.matricula,onChange:s=>m("matricula",s.target.value),className:"mb-2"}),e.jsx(x,{placeholder:"Lugar de Origen",defaultValue:a.lugarDeOrigen,onChange:s=>m("lugarDeOrigen",s.target.value),className:"mb-2"}),e.jsx(x,{placeholder:"Información Extra",defaultValue:a.infoExtra,onChange:s=>m("infoExtra",s.target.value),className:"mb-2"}),e.jsx(x,{type:"file",accept:"image/*",onChange:s=>{if(s.target.files){const r=s.target.files[0],l=new FileReader;l.onloadend=()=>{l.result&&m("profileImageUrl",l.result)},l.readAsDataURL(r)}},className:"hidden"}),e.jsx(g,{onClick:()=>{document.querySelector('input[type="file"]').click()},className:"block mb-2 bg-customBlue p-1 text-white rounded-full",children:"Subir Imagen"}),e.jsx(g,{onClick:async()=>{await I(a.id),window.location.reload()},className:"bg-customGreen text-white",children:"Guardar Cambios"})]})})})]},a.id)):e.jsx(b,{children:e.jsx(d,{colSpan:6,className:"text-center py-4",children:"No se encontraron usuarios."})})})]}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(g,{onClick:()=>j(a=>Math.max(a-1,1)),className:"disabled:opacity-10",disabled:p===1,children:"Atrás"}),e.jsx("div",{className:"flex space-x-2",children:Array.from({length:w},(a,s)=>e.jsx(A,{onClick:()=>j(s+1),className:`${p===s+1?"opacity-100":"opacity-50"} bg-blue-200 transition-opacity duration-200`,children:s+1},s+1))}),e.jsx(g,{onClick:()=>j(a=>Math.min(a+1,w)),className:"disabled:opacity-10",disabled:p===w,children:"Siguiente"})]})]})};export{Q as default};
